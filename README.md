# Задача "Понимание JVM"
## Имеется следующий код:
```java
public class JvmComprehension {

    public static void main(String[] args) {
        int i = 1;                      // 1
        Object o = new Object();        // 2
        Integer ii = 2;                 // 3
        printAll(o, i, ii);             // 4
        System.out.println("finished"); // 7
    }

    private static void printAll(Object o, int i, Integer ii) {
        Integer uselessVar = 700;                   // 5
        System.out.println(o.toString() + i + ii);  // 6
    }
}
```
### Разберем по пунктам (строчкам)
1. На момент инициализации переменной "i" уже было выполнен ряд действий виртуальной машиной: наш класс JvmComprehension
 при помощи ClassLoader'ов был загружен (вместе с системными классами) в метаспейс, произведена верификация кода и инициализация.
 Затем в момент вызова метода main в стеке создается первый фрейм.
 Итак, после этих действий в первом фрейме инициализируется переменная "i".
2. В этом пункте происходит создание объекта типа Object. Оператор new выделяет память в хипе, конструктором Object() создается объект
и ссылка на переменную "о" типа Object попадает в стек во фрейм метода main.
3. Integer - ссылочный тип данных, поэтому ссылка "ii" сохраняется во фрейме метода main, а сам объект со значением 2 - в хипе.
4. В этом пункте происходит вызов метода printAll с параметрами. В стеке создается новый фрейм. 
Далее в этом фрейме записываются параметры: ссылки "о" и "ii" на ранее созданные объекты, а так же записывается примитивная переменная i = 1.
5. В хипе создается объект типа Integer со значением 700. Ссылка на этот объект uselessVar попадает во фрейм метода printAll.
6. В этом пункте происходит выполнение двух методов: сначала вызывается метод toString для объекта "о" и в стеке создается для него фрейм со ссылкой на объект "о". Этот метод возвращает строку "java.lang.Object@....", удаляется ссылка на объект "о" и затем сам фрейм. Далее вызывается метод println и также создается новый фрейм. Этот метод выводит в консоль конкатенацию: результат работы метода toString, значение переменной "i" и значение объекта "ii". Удаляется фрейм метода println, а затем и метода printAll.
7. Вызывается метод println, ему в параметр передается строка. Создается новый фрейм для этого метода, во фрейм записывается ссылка на строку "finished", которая хранится в пуле строк (куче). Выполняется метод -> выводится в консоль строка "finished"-> завершается метод, удаляется фрейм метода println из стека. 
Далее удаляется из стека фрейм метода main. Программа завершается, занятая памать освобождается.

В процессе работы программы JVM самостоятельно вызывает сборщик мусора, удаляя из хипа неиспользуемые объекты. Переместимся в пункт № 7. На этом этапе уже был завершен метод printAll, и поэтому созданные им объекты (uselessVar и результат работы метода toString) остались без ссылок. JVM при следующем вызове garbage collector может удалить эти объекты. 
